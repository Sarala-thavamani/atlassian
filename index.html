<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://unpkg.com/@atlaskit/css-reset@2.0.0/dist/bundle.css" media="all">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <section id="content" class="ac-content">
        <h1>Hello World</h1>
        <p>Welcome to your Atlassian Connect app! Here are some interactive features:</p>
        
        <!-- New Button for Jira -->
        <button id="push-to-jira-btn" class="atlaskit-button">Push to Jira</button>
        
        <script>
            // Encode Basic Auth credentials
            const authToken = btoa("apiuser@vistrivetech.com:ATATT3xFfGF01tDKvQhVWIQcuc--2t8wXnAgV0ZIvSceWBhhp51i77B9eqoYpeb9p015WdqnTQowqPfScbY7VN_LmedzKfmDVANS8rPn1B8_3CEoF6h7UYqoABOqe7t2ElY_VZ-BFmdXHYRcvbwwEDMf7Xbk8U86idrPHyVj-ClyZfwJ279xs1Q=3909EF1F");

            // Button to Push to Jira
            $("#push-to-jira-btn").on("click", function() {
                var settings = {
                    url: "https://cn2.atlassian.net/rest/api/3/issue",
                    method: "POST",
                    timeout: 0,
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": "Basic " + authToken
                    },
                    data: JSON.stringify({
                        fields: {
                            description: {
                                content: [
                                    {
                                        content: [
                                            {
                                                text: "This is a test issue created via API.",
                                                type: "text"
                                            }
                                        ],
                                        type: "paragraph"
                                    }
                                ],
                                type: "doc",
                                version: 1
                            },
                            issuetype: {
                                id: "10016" // Replace with your issue type ID
                            },
                            project: {
                                id: "10005" // Replace with your project ID
                            },
                            summary: "Test issue from the web app"
                        }
                    })
                };

                $.ajax(settings)
                    .done(function(response) {
                        console.log("Issue created successfully:", response);
                        alert("Issue created successfully with ID: " + response.key);
                    })
                    .fail(function(xhr, status, error) {
                        console.error("Failed to create issue:", error);
                        alert("Failed to create issue. Error: " + xhr.responseText);
                    });
            });
        </script>
    </section>
</body>
</html>